<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.qf.dao.DeptMapper" >
  <resultMap id="BaseResultMap" type="com.qf.entity.Dept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 22 22:26:37 CST 2019.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="dname" property="dname" jdbcType="VARCHAR" />
    <result column="ddesc" property="ddesc" jdbcType="VARCHAR" />
    <result column="dparentid" property="dparentid" jdbcType="INTEGER" />
    <result column="dindex" property="dindex" jdbcType="INTEGER" />
    <result column="dstate" property="dstate" jdbcType="INTEGER" />
    <result column="create_time" property="createTime"/>
    <result column="parentname" property="parentname"/>
    <result column="subId" property="subId"/>
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 22 22:26:37 CST 2019.
    -->
    id, dname, ddesc, dparentid, dindex, dstate
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
	SELECT
		d.*, 
		p.dname as parentname
	FROM
		t_dept d
	LEFT JOIN t_dept p ON (d.dparentid = p.id)
	WHERE
		d.id = #{id}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 22 22:26:37 CST 2019.
    -->
    delete from t_dept
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.qf.entity.Dept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 22 22:26:37 CST 2019.
    -->
    insert into t_dept (id, dname, ddesc, 
      dparentid, dindex, dstate
      )
    values (#{id,jdbcType=INTEGER}, #{dname,jdbcType=VARCHAR}, #{ddesc,jdbcType=VARCHAR}, 
      #{dparentid,jdbcType=INTEGER}, #{dindex,jdbcType=INTEGER}, #{dstate,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.qf.entity.Dept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 22 22:26:37 CST 2019.
    -->
    insert into t_dept
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="dname != null" >
        dname,
      </if>
      <if test="ddesc != null" >
        ddesc,
      </if>
      <if test="dparentid != null" >
        dparentid,
      </if>
      <if test="dindex != null" >
        dindex,
      </if>
      <if test="dstate != null" >
        dstate,
      </if>
      create_time
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="dname != null" >
        #{dname,jdbcType=VARCHAR},
      </if>
      <if test="ddesc != null" >
        #{ddesc,jdbcType=VARCHAR},
      </if>
      <if test="dparentid != null" >
        #{dparentid,jdbcType=INTEGER},
      </if>
      <if test="dindex != null" >
        #{dindex,jdbcType=INTEGER},
      </if>
      <if test="dstate != null" >
        #{dstate,jdbcType=INTEGER},
      </if>
     	now()
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.qf.entity.Dept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 22 22:26:37 CST 2019.
    -->
    update t_dept
    <set >
      <if test="dname != null" >
        dname = #{dname,jdbcType=VARCHAR},
      </if>
      <if test="ddesc != null" >
        ddesc = #{ddesc,jdbcType=VARCHAR},
      </if>
      <if test="dparentid != null" >
        dparentid = #{dparentid,jdbcType=INTEGER},
      </if>
      <if test="dindex != null" >
        dindex = #{dindex,jdbcType=INTEGER},
      </if>
      <if test="dstate != null" >
        dstate = #{dstate,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.qf.entity.Dept" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Apr 22 22:26:37 CST 2019.
    -->
    update t_dept
    set dname = #{dname,jdbcType=VARCHAR},
      ddesc = #{ddesc,jdbcType=VARCHAR},
      dparentid = #{dparentid,jdbcType=INTEGER},
      dindex = #{dindex,jdbcType=INTEGER},
      dstate = #{dstate,jdbcType=INTEGER}
    where id = #{id,jdbcType=INTEGER}
  </update>
  
  <select id="getList" resultMap="BaseResultMap">
	SELECT
		d.*, ifnull(p.dname, 'æ— ') as parentname
	FROM
		t_dept d
	LEFT JOIN t_dept p ON (d.dparentid = p.id)
	ORDER BY dindex,create_time
  </select>
  
  <select id="getParentDeptList" resultMap="BaseResultMap">
  		SELECT
			d.*,
			s.id as subId
		FROM
			t_dept d
		LEFT JOIN t_dept s ON (d.id = s.dparentid)
		where d.dparentid = #{id}
		group by d.id
  </select>
  
  <delete id="batchDel">
  	delete from ${table_name} where id in
  	<foreach collection="ids" item="id" open="(" close=")" separator=",">
  		#{id}
  	</foreach>
  </delete>
</mapper>